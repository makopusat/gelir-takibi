<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Gelir Gider Uygulaması</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 480px;
      margin: 20px auto;
      padding: 10px;
    }
    input, select, button {
      padding: 8px;
      margin: 6px 0;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Gelir Gider Uygulaması</h1>

  <!-- Başlangıç ekranı -->
  <div id="startDiv">
    <button onclick="showRegister()">Kayıt Ol</button>
    <button onclick="showLogin()">Giriş Yap</button>
  </div>

  <!-- Kayıt formu -->
  <div id="registerDiv" style="display:none;">
    <h2>Kayıt Ol</h2>
    <input type="email" id="registerEmail" placeholder="Email" />
    <input type="password" id="registerPassword" placeholder="Şifre" />
    <button onclick="register()">Kayıt Ol</button>
    <button onclick="showLogin()">Zaten hesabım var, Giriş Yap</button>
  </div>

  <!-- Giriş formu -->
  <div id="loginDiv" style="display:none;">
    <h2>Giriş Yap</h2>
    <input type="email" id="loginEmail" placeholder="Email" />
    <input type="password" id="loginPassword" placeholder="Şifre" />
    <button onclick="login()">Giriş Yap</button>
    <button onclick="showRegister()">Hesabın yok mu? Kayıt Ol</button>
  </div>

  <!-- Uygulama ana ekranı -->
  <div id="appDiv" style="display:none;">
    <p id="welcome"></p>
    <button onclick="logout()">Çıkış Yap</button>
    <!-- Buraya uygulama içeriği gelecek -->
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getAuth,
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      signOut,
      onAuthStateChanged,
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

    // Firebase config'unu kendi projenle değiştir
    const firebaseConfig = {
      apiKey: "AIzaSyCTZXqmpVQeYwm2PoDwEYih9vDDl3A5rtI",
      authDomain: "gelir-gider-d3dc3.firebaseapp.com",
      projectId: "gelir-gider-d3dc3",
      storageBucket: "gelir-gider-d3dc3.appspot.com",
      messagingSenderId: "791363419549",
      appId: "1:791363419549:web:724a349a5efcd6b7c30374",
      measurementId: "G-B8NKY7SR14",
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    function showRegister() {
      document.getElementById("startDiv").style.display = "none";
      document.getElementById("loginDiv").style.display = "none";
      document.getElementById("registerDiv").style.display = "block";
      document.getElementById("appDiv").style.display = "none";
    }

    function showLogin() {
      document.getElementById("startDiv").style.display = "none";
      document.getElementById("registerDiv").style.display = "none";
      document.getElementById("loginDiv").style.display = "block";
      document.getElementById("appDiv").style.display = "none";
    }

    function showStart() {
      document.getElementById("startDiv").style.display = "block";
      document.getElementById("registerDiv").style.display = "none";
      document.getElementById("loginDiv").style.display = "none";
      document.getElementById("appDiv").style.display = "none";
    }

    async function register() {
      const email = document.getElementById("registerEmail").value.trim();
      const password = document.getElementById("registerPassword").value.trim();
      if (!email || !password) {
        alert("Lütfen email ve şifre giriniz.");
        return;
      }
      try {
        await createUserWithEmailAndPassword(auth, email, password);
        alert("Kayıt başarılı! Lütfen giriş yapınız.");
        showLogin();
      } catch (e) {
        alert("Kayıt hatası: " + e.message);
      }
    }

    async function login() {
      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPassword").value.trim();
      if (!email || !password) {
        alert("Lütfen email ve şifre giriniz.");
        return;
      }
      try {
        await signInWithEmailAndPassword(auth, email, password);
        // Giriş başarılı olursa onAuthStateChanged tetiklenir.
      } catch (e) {
        alert("Giriş hatası: " + e.message);
      }
    }

    async function logout() {
      await signOut(auth);
      showStart();
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        // Kullanıcı giriş yaptı
        document.getElementById("welcome").innerText = `Hoşgeldin, ${user.email}`;
        document.getElementById("appDiv").style.display = "block";
        document.getElementById("startDiv").style.display = "none";
        document.getElementById("loginDiv").style.display = "none";
        document.getElementById("registerDiv").style.display = "none";
      } else {
        // Kullanıcı çıkış yaptı
        showStart();
      }
    });

    window.showRegister = showRegister;
    window.showLogin = showLogin;
    window.register = register;
    window.login = login;
    window.logout = logout;
  </script>
</body>
</html>
